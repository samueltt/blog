1. 随机的控制
2. 人数的控制


---------------------

随机的控制

一次随机金额
```
<?php
function money(){
  $r = rand(0,99);
  $m = rand(0,100);
  if ($r < 50) {
    return 1+0.01*$m;
  } elseif($r <90) {
    return 2+0.01*$m;
  } else {
    return 3+0.01*$m;
  }
}
```

人数的控制

如果限制总人数，那么每次都去 count 数据库这样不够科学。  
一种方法是， 把总人数存在内存中。  
来一个人这个数量加一。
```
$c = redis.get('count');
if($c<10) {
  redis.set('count',1+$c);
}
```

另外一种方式，是取种子方法
提前生成 10 个种子，在队列里面。直到没了种子。
```
$l = list(10);
$s = $l.lpop(1);
// todo ....
```
